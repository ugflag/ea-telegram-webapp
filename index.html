<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>EA Control Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Telegram WebApp API -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin: 0;
  background: #0f172a;
  color: #e5e7eb;
  font-family: Inter, Arial, sans-serif;
  height: 100vh;
}

.container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  padding: 12px;
}

.content {
  flex: 1;
}

/* ===== LAYOUT ===== */
.row {
  display: flex;
  gap: 8px;
  margin-bottom: 10px;
}

.row.center {
  justify-content: center;
}

.row.full button {
  flex: 1;
}

select, button {
  background: #1e293b;
  color: white;
  border: none;
  border-radius: 6px;
  padding: 10px;
  font-size: 14px;
}

button.primary {
  background: #22c55e;
  color: #022c22;
}

button.secondary {
  background: #38bdf8;
  color: #022c22;
}

button.danger {
  background: #ef4444;
}

button.active {
  outline: 2px solid #facc15;
}

/* ===== FAVORITES LIST ===== */
.favorites {
  border: 1px dashed #334155;
  padding: 8px;
  border-radius: 6px;
  margin-bottom: 12px;
}

.fav-item {
  padding: 6px;
  border-radius: 4px;
  cursor: pointer;
}

.fav-item:hover {
  background: #1e293b;
}

/* ===== FOOTER ===== */
.footer {
  margin-top: auto;
}
</style>
</head>

<body>
<div class="container">

  <div class="content">

    <h3 style="text-align:center;margin:8px 0;">EA Control Panel</h3>

    <!-- INSTRUMENT SELECTORS -->
    <div class="row">
      <select id="forexMenu">
        <option value="">Forex / Commodities</option>
        <option value="FAV">⭐ Favored</option>
        <option value="EURUSD">EURUSD</option>
        <option value="GBPUSD" data-fav="1">GBPUSD ⭐</option>
        <option value="XAUUSD">XAUUSD</option>
      </select>

      <select id="vixMenu">
        <option value="">Synthetics / VIX</option>
        <option value="FAV">⭐ Favored</option>
        <option value="JUMP50">JUMP 50</option>
        <option value="STEP" data-fav="1">STEP Index ⭐</option>
        <option value="V75" data-fav="1">Volatility 75 ⭐</option>
      </select>
    </div>

    <!-- FAVORITES DISPLAY -->
    <div class="favorites" id="favList">
      <div>Select instrument from menu above</div>
    </div>

    <!-- INFO ROW -->
    <div class="row full">
      <button class="primary">EA Name</button>
      <button class="primary">Account Info</button>
      <button class="primary">Active Charts</button>
    </div>

    <!-- MARKET ROW -->
    <div class="row full">
      <button class="secondary">Quotes</button>
      <button class="secondary">Screenshot</button>
    </div>

    <!-- TRADE ROW -->
    <div class="row full">
      <button class="primary" onclick="sendAction('BUY')">Buy</button>
      <button class="primary" onclick="sendAction('SELL')">Sell</button>
      <button class="danger" onclick="sendAction('CLOSE')">Close</button>
      <button class="secondary">Adjust</button>
    </div>

    <!-- STATUS ROW -->
    <div class="row full">
      <button>Status</button>
      <button>Results</button>
    </div>

  </div>

  <!-- FOOTER (LOCKED TO BOTTOM) -->
  <div class="row footer full">
    <button>Contact Us</button>
    <button>Join Us</button>
  </div>

</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let selectedInstrument = "";

function updateFavorites(type) {
  const list = document.getElementById("favList");
  list.innerHTML = "";

  let menu = type === "forex"
    ? document.getElementById("forexMenu")
    : document.getElementById("vixMenu");

  let favs = [];
  for (let opt of menu.options) {
    if (opt.dataset.fav === "1") favs.push(opt.value);
  }

  if (favs.length === 0) {
    list.innerHTML = "<div>Select instrument from menu above</div>";
    return;
  }

  favs.forEach(sym => {
    let div = document.createElement("div");
    div.className = "fav-item";
    div.textContent = sym;
    div.onclick = () => {
      selectedInstrument = sym;
      document.querySelectorAll(".fav-item").forEach(e => e.classList.remove("active"));
      div.classList.add("active");
    };
    list.appendChild(div);
  });
}

document.getElementById("forexMenu").onchange = function () {
  if (this.value === "FAV") updateFavorites("forex");
  else if (this.value) selectedInstrument = this.value;
};

document.getElementById("vixMenu").onchange = function () {
  if (this.value === "FAV") updateFavorites("vix");
  else if (this.value) selectedInstrument = this.value;
};

function sendAction(action) {
  tg.sendData(JSON.stringify({
    action,
    symbol: selectedInstrument,
    time: Date.now()
  }));
}
</script>

</body>
</html>
